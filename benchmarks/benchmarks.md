# Numerical Benchmarks
## Overview
The accuracy and capability of the developed approach are evaluated using synthetic data generated using analytical constitutive models. Numerically generated data offers the benefit of having exact knowledge of the ground truth, i.e., the constitutive model that underlies the data.

To mimic idealized experiments, numerical data sets for training, validation, and testing are generated using standard protocols in experimental mechanics. For each protocol, stress values and dissipative state variables are sampled at regular intervals. Additionally, the approach's robustness to errors in the training data is assessed by introducing synthetic noise.

## Benchmarks Selection
Two benchmarks are selected to highlight challenges in learning constitutive representations in small data regimes: a one-state variable model ($\boldsymbol{\varepsilon}^e$\) and a three-state variables model ($\rho, \boldsymbol{\varepsilon}^e, \boldsymbol{z}$).

## Data Splitting
The entire data set is split into training, validation, and test sets in approximately a 60-20-20% ratio.

## Implementation Details
The new algorithm is implemented using the deep learning library **PyTorch** and the package **torchdiffeq** for time integration and back-propagation. The explicit midpoint method is used with a time step $h = \frac{T}{800}$.


## Benchmark 1: elasto-plastic media
### Model Description
The first example concerns an incrementally nonlinear elasto-plastic, non-associative, Drucker-Prager material with constant density [1]. The specific internal energy is defined as:

$\hat{u}(\boldsymbol{\varepsilon^e}) = \dfrac{1}{2}K{\varepsilon_v^e}^2 + \dfrac{3}{2}G{\varepsilon^e_s}^2$

### Model Parameters
$K=70$ GPa, $G=60$ GPa, friction coefficient equal to one, seismic parameter equal to one, and dilatancy parameter equal to one half.

### Data Generation
Data is generated by applying single loading-unloading paths with constant strain rate. The material stress is identified in terms of its volumetric and deviatoric parts.

### Neural Network Architecture
The neural operator $f_{\boldsymbol{\theta}}$ is composed of three hidden layers with 36 nodes (Gaussian error linear unit activations, $\mathrm{GELU}(x) = 1.702x^2/(1+e^{-1.7x })$ and one linear output layer, while $u_{\boldsymbol{\omega}}$ consists of two hidden layers with 64 units (softplus activations $s^+(x) = log (1+e^x)$ ) and one linear output layer. The training is performed for the entire batch of training data, using Adam optimizer, with adaptive learning rate, with upper and lower bounds equal to $10^{-2}$ and $10^{-4}$, respectively.


## Benchmark 2: elasto-plastic porous media
### Model Description
The second example concerns elasto-plastic porous media [2]. The reference constitutive model is built on three state variables: elastic strain ($\boldsymbol{\varepsilon}^e$), bulk density ($\rho$), and solid fraction ($\phi=\frac{\rho}{\rho_s}$).

### Model Parameters
Bulk modulus $K=10$ MPa, shear modulus $G=6$ MPa, critical state line slope $M=1.5$, effective isotropic yield pressure $\beta^*=0.1$, and unstressed solid density 600 kg/m³.

### Data Generation
Data is generated by applying single loading-unloading strain-loading paths with constant strain rate. Four specimens with different initial solid fractions are considered.

### Neural Network Architecture
The neural operator $f_{\boldsymbol{\theta}}$ is composed of three hidden layers with 42 nodes (Gaussian error linear unit activations) and one linear output layer, while $u_{\boldsymbol{\omega}}$ consists of two hidden layers with 64 nodes (softplus activations) and a linear output layer. The same training procedure as in the first becnhmark is followed.

## Figures
Refer to the repository for loading paths and protocols diagrams.

## References
[1]: I Einav. The unification of hypo-plastic and elasto-plastic theories. *International Journal of Solids and Structures*, 49(11-12):1305–1315, 2012. doi: 10.1016/j.ijsolstr.2012.02.003.

[2]: D Riley, I Einav, and F Guillard. A constitutive model for porous media with recurring stress drops: From snow to foams and cereals. *International Journal of Solids and Structures*, 262:112044, 2023. doi: 10.1016/j.ijsolstr.2022.112044.
